54e8ec1259e0d7e7fcf3fc17fa1c0c7f
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[typeof Symbol === "function" ? Symbol.iterator : "@@iterator"] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } it = o[typeof Symbol === "function" ? Symbol.iterator : "@@iterator"](); return it.next.bind(it); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

var React = require('react');

var Text = require("../../Text/Text");

var UTFSequence = require("../../UTFSequence");

var stringifySafe = require("../../Utilities/stringifySafe");

var SUBSTITUTION = UTFSequence.BOM + '%s';
var YellowBoxCategory = {
  parse: function parse(args) {
    var categoryParts = [];
    var contentParts = [];
    var substitutionOffsets = [];
    var remaining = (0, _toConsumableArray2.default)(args);

    if (typeof remaining[0] === 'string') {
      var formatString = String(remaining.shift());
      var formatStringParts = formatString.split('%s');
      var substitutionCount = formatStringParts.length - 1;
      var substitutions = remaining.splice(0, substitutionCount);
      var categoryString = '';
      var contentString = '';
      var substitutionIndex = 0;

      for (var _iterator = _createForOfIteratorHelperLoose(formatStringParts), _step; !(_step = _iterator()).done;) {
        var formatStringPart = _step.value;
        categoryString += formatStringPart;
        contentString += formatStringPart;

        if (substitutionIndex < substitutionCount) {
          if (substitutionIndex < substitutions.length) {
            var substitution = stringifySafe(substitutions[substitutionIndex]);
            substitutionOffsets.push({
              length: substitution.length,
              offset: contentString.length
            });
            categoryString += SUBSTITUTION;
            contentString += substitution;
          } else {
            substitutionOffsets.push({
              length: 2,
              offset: contentString.length
            });
            categoryString += '%s';
            contentString += '%s';
          }

          substitutionIndex++;
        }
      }

      categoryParts.push(categoryString);
      contentParts.push(contentString);
    }

    var remainingArgs = remaining.map(stringifySafe);
    categoryParts.push.apply(categoryParts, (0, _toConsumableArray2.default)(remainingArgs));
    contentParts.push.apply(contentParts, (0, _toConsumableArray2.default)(remainingArgs));
    return {
      category: categoryParts.join(' '),
      message: {
        content: contentParts.join(' '),
        substitutions: substitutionOffsets
      }
    };
  },
  render: function render(_ref, substitutionStyle) {
    var content = _ref.content,
        substitutions = _ref.substitutions;
    var elements = [];
    var lastOffset = substitutions.reduce(function (prevOffset, substitution, index) {
      var key = String(index);

      if (substitution.offset > prevOffset) {
        var prevPart = content.substr(prevOffset, substitution.offset - prevOffset);
        elements.push(React.createElement(Text, {
          key: key
        }, prevPart));
      }

      var substititionPart = content.substr(substitution.offset, substitution.length);
      elements.push(React.createElement(Text, {
        key: key + '.5',
        style: substitutionStyle
      }, substititionPart));
      return substitution.offset + substitution.length;
    }, 0);

    if (lastOffset < content.length) {
      var lastPart = content.substr(lastOffset);
      elements.push(React.createElement(Text, {
        key: "-1"
      }, lastPart));
    }

    return elements;
  }
};
module.exports = YellowBoxCategory;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlllbGxvd0JveENhdGVnb3J5LmpzIl0sIm5hbWVzIjpbIlJlYWN0IiwicmVxdWlyZSIsIlRleHQiLCJVVEZTZXF1ZW5jZSIsInN0cmluZ2lmeVNhZmUiLCJTVUJTVElUVVRJT04iLCJCT00iLCJZZWxsb3dCb3hDYXRlZ29yeSIsInBhcnNlIiwiYXJncyIsImNhdGVnb3J5UGFydHMiLCJjb250ZW50UGFydHMiLCJzdWJzdGl0dXRpb25PZmZzZXRzIiwicmVtYWluaW5nIiwiZm9ybWF0U3RyaW5nIiwiU3RyaW5nIiwic2hpZnQiLCJmb3JtYXRTdHJpbmdQYXJ0cyIsInNwbGl0Iiwic3Vic3RpdHV0aW9uQ291bnQiLCJsZW5ndGgiLCJzdWJzdGl0dXRpb25zIiwic3BsaWNlIiwiY2F0ZWdvcnlTdHJpbmciLCJjb250ZW50U3RyaW5nIiwic3Vic3RpdHV0aW9uSW5kZXgiLCJmb3JtYXRTdHJpbmdQYXJ0Iiwic3Vic3RpdHV0aW9uIiwicHVzaCIsIm9mZnNldCIsInJlbWFpbmluZ0FyZ3MiLCJtYXAiLCJjYXRlZ29yeSIsImpvaW4iLCJtZXNzYWdlIiwiY29udGVudCIsInJlbmRlciIsInN1YnN0aXR1dGlvblN0eWxlIiwiZWxlbWVudHMiLCJsYXN0T2Zmc2V0IiwicmVkdWNlIiwicHJldk9mZnNldCIsImluZGV4Iiwia2V5IiwicHJldlBhcnQiLCJzdWJzdHIiLCJzdWJzdGl0aXRpb25QYXJ0IiwibGFzdFBhcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFVQTs7Ozs7Ozs7Ozs7O0FBRUEsSUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxJQUFNQyxJQUFJLEdBQUdELE9BQU8sbUJBQXBCOztBQUNBLElBQU1FLFdBQVcsR0FBR0YsT0FBTyxxQkFBM0I7O0FBRUEsSUFBTUcsYUFBYSxHQUFHSCxPQUFPLGlDQUE3Qjs7QUFlQSxJQUFNSSxZQUFZLEdBQUdGLFdBQVcsQ0FBQ0csR0FBWixHQUFrQixJQUF2QztBQUVB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Q0Q7QUE3R3VCLENBQTFCO0FBZ0hBVSxNQUFNLENBQUNDLE9BQVAsR0FBaUIxQyxpQkFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgRmFjZWJvb2ssIEluYy4gYW5kIGl0cyBhZmZpbGlhdGVzLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBmbG93IHN0cmljdC1sb2NhbFxuICogQGZvcm1hdFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpO1xuY29uc3QgVGV4dCA9IHJlcXVpcmUoJy4uLy4uL1RleHQvVGV4dCcpO1xuY29uc3QgVVRGU2VxdWVuY2UgPSByZXF1aXJlKCcuLi8uLi9VVEZTZXF1ZW5jZScpO1xuXG5jb25zdCBzdHJpbmdpZnlTYWZlID0gcmVxdWlyZSgnLi4vLi4vVXRpbGl0aWVzL3N0cmluZ2lmeVNhZmUnKTtcblxuaW1wb3J0IHR5cGUge1RleHRTdHlsZVByb3B9IGZyb20gJy4uLy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldCc7XG5cbmV4cG9ydCB0eXBlIENhdGVnb3J5ID0gc3RyaW5nO1xuZXhwb3J0IHR5cGUgTWVzc2FnZSA9ICRSZWFkT25seTx7fFxuICBjb250ZW50OiBzdHJpbmcsXG4gIHN1YnN0aXR1dGlvbnM6ICRSZWFkT25seUFycmF5PFxuICAgICRSZWFkT25seTx7fFxuICAgICAgbGVuZ3RoOiBudW1iZXIsXG4gICAgICBvZmZzZXQ6IG51bWJlcixcbiAgICB8fT4sXG4gID4sXG58fT47XG5cbmNvbnN0IFNVQlNUSVRVVElPTiA9IFVURlNlcXVlbmNlLkJPTSArICclcyc7XG5cbmNvbnN0IFllbGxvd0JveENhdGVnb3J5ID0ge1xuICBwYXJzZShcbiAgICBhcmdzOiAkUmVhZE9ubHlBcnJheTxtaXhlZD4sXG4gICk6ICRSZWFkT25seTx7fFxuICAgIGNhdGVnb3J5OiBDYXRlZ29yeSxcbiAgICBtZXNzYWdlOiBNZXNzYWdlLFxuICB8fT4ge1xuICAgIGNvbnN0IGNhdGVnb3J5UGFydHMgPSBbXTtcbiAgICBjb25zdCBjb250ZW50UGFydHMgPSBbXTtcbiAgICBjb25zdCBzdWJzdGl0dXRpb25PZmZzZXRzID0gW107XG5cbiAgICBjb25zdCByZW1haW5pbmcgPSBbLi4uYXJnc107XG5cbiAgICBpZiAodHlwZW9mIHJlbWFpbmluZ1swXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IGZvcm1hdFN0cmluZyA9IFN0cmluZyhyZW1haW5pbmcuc2hpZnQoKSk7XG4gICAgICBjb25zdCBmb3JtYXRTdHJpbmdQYXJ0cyA9IGZvcm1hdFN0cmluZy5zcGxpdCgnJXMnKTtcbiAgICAgIGNvbnN0IHN1YnN0aXR1dGlvbkNvdW50ID0gZm9ybWF0U3RyaW5nUGFydHMubGVuZ3RoIC0gMTtcbiAgICAgIGNvbnN0IHN1YnN0aXR1dGlvbnMgPSByZW1haW5pbmcuc3BsaWNlKDAsIHN1YnN0aXR1dGlvbkNvdW50KTtcblxuICAgICAgbGV0IGNhdGVnb3J5U3RyaW5nID0gJyc7XG4gICAgICBsZXQgY29udGVudFN0cmluZyA9ICcnO1xuXG4gICAgICBsZXQgc3Vic3RpdHV0aW9uSW5kZXggPSAwO1xuICAgICAgZm9yIChjb25zdCBmb3JtYXRTdHJpbmdQYXJ0IG9mIGZvcm1hdFN0cmluZ1BhcnRzKSB7XG4gICAgICAgIGNhdGVnb3J5U3RyaW5nICs9IGZvcm1hdFN0cmluZ1BhcnQ7XG4gICAgICAgIGNvbnRlbnRTdHJpbmcgKz0gZm9ybWF0U3RyaW5nUGFydDtcblxuICAgICAgICBpZiAoc3Vic3RpdHV0aW9uSW5kZXggPCBzdWJzdGl0dXRpb25Db3VudCkge1xuICAgICAgICAgIGlmIChzdWJzdGl0dXRpb25JbmRleCA8IHN1YnN0aXR1dGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBzdWJzdGl0dXRpb24gPSBzdHJpbmdpZnlTYWZlKFxuICAgICAgICAgICAgICBzdWJzdGl0dXRpb25zW3N1YnN0aXR1dGlvbkluZGV4XSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBzdWJzdGl0dXRpb25PZmZzZXRzLnB1c2goe1xuICAgICAgICAgICAgICBsZW5ndGg6IHN1YnN0aXR1dGlvbi5sZW5ndGgsXG4gICAgICAgICAgICAgIG9mZnNldDogY29udGVudFN0cmluZy5sZW5ndGgsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgY2F0ZWdvcnlTdHJpbmcgKz0gU1VCU1RJVFVUSU9OO1xuICAgICAgICAgICAgY29udGVudFN0cmluZyArPSBzdWJzdGl0dXRpb247XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1YnN0aXR1dGlvbk9mZnNldHMucHVzaCh7XG4gICAgICAgICAgICAgIGxlbmd0aDogMixcbiAgICAgICAgICAgICAgb2Zmc2V0OiBjb250ZW50U3RyaW5nLmxlbmd0aCxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjYXRlZ29yeVN0cmluZyArPSAnJXMnO1xuICAgICAgICAgICAgY29udGVudFN0cmluZyArPSAnJXMnO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHN1YnN0aXR1dGlvbkluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY2F0ZWdvcnlQYXJ0cy5wdXNoKGNhdGVnb3J5U3RyaW5nKTtcbiAgICAgIGNvbnRlbnRQYXJ0cy5wdXNoKGNvbnRlbnRTdHJpbmcpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlbWFpbmluZ0FyZ3MgPSByZW1haW5pbmcubWFwKHN0cmluZ2lmeVNhZmUpO1xuICAgIGNhdGVnb3J5UGFydHMucHVzaCguLi5yZW1haW5pbmdBcmdzKTtcbiAgICBjb250ZW50UGFydHMucHVzaCguLi5yZW1haW5pbmdBcmdzKTtcblxuICAgIHJldHVybiB7XG4gICAgICBjYXRlZ29yeTogY2F0ZWdvcnlQYXJ0cy5qb2luKCcgJyksXG4gICAgICBtZXNzYWdlOiB7XG4gICAgICAgIGNvbnRlbnQ6IGNvbnRlbnRQYXJ0cy5qb2luKCcgJyksXG4gICAgICAgIHN1YnN0aXR1dGlvbnM6IHN1YnN0aXR1dGlvbk9mZnNldHMsXG4gICAgICB9LFxuICAgIH07XG4gIH0sXG5cbiAgcmVuZGVyKFxuICAgIHtjb250ZW50LCBzdWJzdGl0dXRpb25zfTogTWVzc2FnZSxcbiAgICBzdWJzdGl0dXRpb25TdHlsZTogVGV4dFN0eWxlUHJvcCxcbiAgKTogUmVhY3QuTm9kZSB7XG4gICAgY29uc3QgZWxlbWVudHMgPSBbXTtcblxuICAgIGNvbnN0IGxhc3RPZmZzZXQgPSBzdWJzdGl0dXRpb25zLnJlZHVjZShcbiAgICAgIChwcmV2T2Zmc2V0LCBzdWJzdGl0dXRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGtleSA9IFN0cmluZyhpbmRleCk7XG5cbiAgICAgICAgaWYgKHN1YnN0aXR1dGlvbi5vZmZzZXQgPiBwcmV2T2Zmc2V0KSB7XG4gICAgICAgICAgY29uc3QgcHJldlBhcnQgPSBjb250ZW50LnN1YnN0cihcbiAgICAgICAgICAgIHByZXZPZmZzZXQsXG4gICAgICAgICAgICBzdWJzdGl0dXRpb24ub2Zmc2V0IC0gcHJldk9mZnNldCxcbiAgICAgICAgICApO1xuICAgICAgICAgIGVsZW1lbnRzLnB1c2goPFRleHQga2V5PXtrZXl9PntwcmV2UGFydH08L1RleHQ+KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN1YnN0aXRpdGlvblBhcnQgPSBjb250ZW50LnN1YnN0cihcbiAgICAgICAgICBzdWJzdGl0dXRpb24ub2Zmc2V0LFxuICAgICAgICAgIHN1YnN0aXR1dGlvbi5sZW5ndGgsXG4gICAgICAgICk7XG4gICAgICAgIGVsZW1lbnRzLnB1c2goXG4gICAgICAgICAgPFRleHQga2V5PXtrZXkgKyAnLjUnfSBzdHlsZT17c3Vic3RpdHV0aW9uU3R5bGV9PlxuICAgICAgICAgICAge3N1YnN0aXRpdGlvblBhcnR9XG4gICAgICAgICAgPC9UZXh0PixcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gc3Vic3RpdHV0aW9uLm9mZnNldCArIHN1YnN0aXR1dGlvbi5sZW5ndGg7XG4gICAgICB9LFxuICAgICAgMCxcbiAgICApO1xuXG4gICAgaWYgKGxhc3RPZmZzZXQgPCBjb250ZW50Lmxlbmd0aCkge1xuICAgICAgY29uc3QgbGFzdFBhcnQgPSBjb250ZW50LnN1YnN0cihsYXN0T2Zmc2V0KTtcbiAgICAgIGVsZW1lbnRzLnB1c2goPFRleHQga2V5PVwiLTFcIj57bGFzdFBhcnR9PC9UZXh0Pik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnRzO1xuICB9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBZZWxsb3dCb3hDYXRlZ29yeTtcbiJdfQ==